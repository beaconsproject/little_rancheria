# Predictor variables


# Introduction

Exploratory data analysis on predictor variables.

``` r
gps <- st_read('../../data/yt_caribou.gpkg', 'gps_vars', quiet=TRUE) |>
  st_drop_geometry() |>
  mutate(pa=occurrence, fpa=as.factor(occurrence)) |>
  mutate(occurrence=NULL) |>
  as.data.frame()
landcov <- rast('../../data/raster30/landcov.tif')
topo <- rast('../../data/raster30/topo.tif')
fires <- rast('../../data/raster30/fires.tif')
dist2line <- rast('../../data/raster30/dist2line.tif')
dist2poly <- rast('../../data/raster30/dist2poly.tif')
```

## Categorical predictors

### Forest

``` r
plot(landcov[["forest"]])
```

![](3.0-covariates-eda_files/figure-commonmark/unnamed-chunk-3-1.png)

``` r
gps1=filter(gps, forest==1)
t1=table(gps1$fpa, gps1$season)
#barplot(t1, beside=T, legend.text=T)
t2 <- tibble(season=c("earlywinter","earlywinter","fallrut","fallrut",
  "latewinter","latewinter","summer","summer"), presence=as.factor(c(0,1,0,1,0,1,0,1)),
  forest=as.numeric(t1))
ggplot(t2, aes(x=season, y=forest, fill=presence)) + 
  geom_bar(stat = "identity", position = 'dodge')
```

![](3.0-covariates-eda_files/figure-commonmark/unnamed-chunk-4-1.png)

### Conifer

``` r
plot(landcov[["conifer"]])
```

![](3.0-covariates-eda_files/figure-commonmark/unnamed-chunk-5-1.png)

``` r
gps1=filter(gps, conifer==1)
t1=table(gps1$fpa, gps1$season)
#barplot(t1, beside=T, legend.text=T)
t2 <- tibble(season=c("earlywinter","earlywinter","fallrut","fallrut",
  "latewinter","latewinter","summer","summer"), presence=as.factor(c(0,1,0,1,0,1,0,1)),
  conifer=as.numeric(t1))
ggplot(t2, aes(x=season, y=conifer, fill=presence)) + 
  geom_bar(stat = "identity", position = 'dodge')
```

![](3.0-covariates-eda_files/figure-commonmark/unnamed-chunk-6-1.png)

### Broadleaf

``` r
plot(landcov[["broadleaf"]])
```

![](3.0-covariates-eda_files/figure-commonmark/unnamed-chunk-7-1.png)

``` r
gps1=filter(gps, broadleaf==1)
t1=table(gps1$fpa, gps1$season)
#barplot(t1, beside=T, legend.text=T)
t2 <- tibble(season=c("earlywinter","earlywinter","fallrut","fallrut",
  "latewinter","latewinter","summer","summer"), presence=as.factor(c(0,1,0,1,0,1,0,1)),
  broadleaf=as.numeric(t1))
ggplot(t2, aes(x=season, y=broadleaf, fill=presence)) + 
  geom_bar(stat = "identity", position = 'dodge')
```

![](3.0-covariates-eda_files/figure-commonmark/unnamed-chunk-8-1.png)

### Mixedwood

``` r
plot(landcov[["mixedwood"]])
```

![](3.0-covariates-eda_files/figure-commonmark/unnamed-chunk-9-1.png)

``` r
gps1=filter(gps, mixedwood==1)
t1=table(gps1$fpa, gps1$season)
#barplot(t1, beside=T, legend.text=T)
t2 <- tibble(season=c("earlywinter","earlywinter","fallrut","fallrut",
  "latewinter","latewinter","summer","summer"), presence=as.factor(c(0,1,0,1,0,1,0,1)),
  mixedwood=as.numeric(t1))
ggplot(t2, aes(x=season, y=mixedwood, fill=presence)) + 
  geom_bar(stat = "identity", position = 'dodge')
```

![](3.0-covariates-eda_files/figure-commonmark/unnamed-chunk-10-1.png)

### Wetland

``` r
plot(landcov[["wetland"]])
```

![](3.0-covariates-eda_files/figure-commonmark/unnamed-chunk-11-1.png)

``` r
gps1=filter(gps, wetland==1)
t1=table(gps1$fpa, gps1$season)
#barplot(t1, beside=T, legend.text=T)
t2 <- tibble(season=c("earlywinter","earlywinter","fallrut","fallrut",
  "latewinter","latewinter","summer","summer"), presence=as.factor(c(0,1,0,1,0,1,0,1)),
  wetland=as.numeric(t1))
ggplot(t2, aes(x=season, y=wetland, fill=presence)) + 
  geom_bar(stat = "identity", position = 'dodge')
```

![](3.0-covariates-eda_files/figure-commonmark/unnamed-chunk-12-1.png)

### Shrubland

``` r
plot(landcov[["shrubland"]])
```

![](3.0-covariates-eda_files/figure-commonmark/unnamed-chunk-13-1.png)

``` r
gps1=filter(gps, shrubland==1)
t1=table(gps1$fpa, gps1$season)
#barplot(t1, beside=T, legend.text=T)
t2 <- tibble(season=c("earlywinter","earlywinter","fallrut","fallrut",
  "latewinter","latewinter","summer","summer"), presence=as.factor(c(0,1,0,1,0,1,0,1)),
  shrubland=as.numeric(t1))
ggplot(t2, aes(x=season, y=shrubland, fill=presence)) + 
  geom_bar(stat = "identity", position = 'dodge')
```

![](3.0-covariates-eda_files/figure-commonmark/unnamed-chunk-14-1.png)

### Grassland

``` r
plot(landcov[["grassland"]])
```

![](3.0-covariates-eda_files/figure-commonmark/unnamed-chunk-15-1.png)

``` r
gps1=filter(gps, grassland==1)
t1=table(gps1$fpa, gps1$season)
#barplot(t1, beside=T, legend.text=T)
t2 <- tibble(season=c("earlywinter","earlywinter","fallrut","fallrut",
  "latewinter","latewinter","summer","summer"), presence=as.factor(c(0,1,0,1,0,1,0,1)),
  grassland=as.numeric(t1))
ggplot(t2, aes(x=season, y=grassland, fill=presence)) + 
  geom_bar(stat = "identity", position = 'dodge')
```

![](3.0-covariates-eda_files/figure-commonmark/unnamed-chunk-16-1.png)

### Barren

``` r
plot(landcov[["barren"]])
```

![](3.0-covariates-eda_files/figure-commonmark/unnamed-chunk-17-1.png)

``` r
gps1=filter(gps, barren==1)
t1=table(gps1$fpa, gps1$season)
#barplot(t1, beside=T, legend.text=T)
t2 <- tibble(season=c("earlywinter","earlywinter","fallrut","fallrut",
  "latewinter","latewinter","summer","summer"), presence=as.factor(c(0,1,0,1,0,1,0,1)),
  barren=as.numeric(t1))
ggplot(t2, aes(x=season, y=barren, fill=presence)) + 
  geom_bar(stat = "identity", position = 'dodge')
```

![](3.0-covariates-eda_files/figure-commonmark/unnamed-chunk-18-1.png)

### Snow and Ice

``` r
plot(landcov[["snowice"]])
```

![](3.0-covariates-eda_files/figure-commonmark/unnamed-chunk-19-1.png)

``` r
gps1=filter(gps, snowice==1)
t1=table(gps1$fpa, gps1$season)
#barplot(t1, beside=T, legend.text=T)
t2 <- tibble(season=c("earlywinter","earlywinter","fallrut","fallrut",
  "latewinter","latewinter","summer","summer"), presence=as.factor(c(0,1,0,1,0,1,0,1)),
  snowice=c(0,0,0,0,0,0,as.numeric(t1)))
ggplot(t2, aes(x=season, y=snowice, fill=presence)) + 
  geom_bar(stat = "identity", position = 'dodge')
```

![](3.0-covariates-eda_files/figure-commonmark/unnamed-chunk-20-1.png)

### Fires

``` r
plot(fires)
```

![](3.0-covariates-eda_files/figure-commonmark/unnamed-chunk-21-1.png)

``` r
gps1=filter(gps, fires==1)
t1=table(gps1$fpa, gps1$season)
#barplot(t1, beside=T, legend.text=T)
t2 <- tibble(season=c("earlywinter","earlywinter","fallrut","fallrut",
  "latewinter","latewinter","summer","summer"), presence=as.factor(c(0,1,0,1,0,1,0,1)),
  fires=as.numeric(t1))
ggplot(t2, aes(x=season, y=fires, fill=presence)) + 
  geom_bar(stat = "identity", position = 'dodge')
```

![](3.0-covariates-eda_files/figure-commonmark/unnamed-chunk-22-1.png)

## Continuous predictors

**Correlation matrix**

Letâ€™s start by looking at a correlation matrix of our continuous
predictors.

``` r
M=cor(gps[c(12:17,19:20)])
corrplot::corrplot(M, method='number')
```

![](3.0-covariates-eda_files/figure-commonmark/unnamed-chunk-23-1.png)

### Distance to linear disturbance

``` r
plot(dist2line)
```

![](3.0-covariates-eda_files/figure-commonmark/unnamed-chunk-24-1.png)

``` r
ggplot(data=gps, aes(x=fpa, y=dist2line)) +
  geom_boxplot() +
  xlab("Absence-Presence") +
  ylab("Distance to line") +
  facet_wrap(~season)
```

![](3.0-covariates-eda_files/figure-commonmark/unnamed-chunk-25-1.png)

### Distance to areal disturbance

``` r
plot(dist2poly)
```

![](3.0-covariates-eda_files/figure-commonmark/unnamed-chunk-26-1.png)

``` r
ggplot(data=gps, aes(x=fpa, y=dist2poly)) +
  geom_boxplot() +
  xlab("Absence-Presence") +
  ylab("Distance to polygon") +
  facet_wrap(~season)
```

![](3.0-covariates-eda_files/figure-commonmark/unnamed-chunk-27-1.png)

### Elevation

``` r
plot(topo[['elevation']])
```

![](3.0-covariates-eda_files/figure-commonmark/unnamed-chunk-28-1.png)

``` r
#dem=topo[['elevation']]
#elevation_matrix <- raster_to_matrix(dem)
#elevation_matrix %>%
#  sphere_shade(texture = "desert") %>%
#  plot_map()
```

``` r
ggplot(data=gps, aes(x=fpa, y=elevation)) +
  geom_boxplot() +
  xlab("Absence-Presence") +
  ylab("Elevation") +
  facet_wrap(~season)
```

![](3.0-covariates-eda_files/figure-commonmark/unnamed-chunk-29-1.png)

### Aspect

``` r
plot(topo[['aspect']])
```

![](3.0-covariates-eda_files/figure-commonmark/unnamed-chunk-30-1.png)

``` r
ggplot(data=gps, aes(x=fpa, y=aspect)) +
  geom_boxplot() +
  xlab("Absence-Presence") +
  ylab("Aspect") +
  facet_wrap(~season)
```

![](3.0-covariates-eda_files/figure-commonmark/unnamed-chunk-31-1.png)

### Slope

``` r
plot(topo[['slope']])
```

![](3.0-covariates-eda_files/figure-commonmark/unnamed-chunk-32-1.png)

``` r
ggplot(data=gps, aes(x=fpa, y=slope)) +
  geom_boxplot() +
  xlab("Absence-Presence") +
  ylab("Slope") +
  facet_wrap(~season)
```

![](3.0-covariates-eda_files/figure-commonmark/unnamed-chunk-33-1.png)

### Roughness

The correlation between slope and roughness is 0.99, so there is no
sense in keeping both.

``` r
plot(topo[['roughness']])
```

![](3.0-covariates-eda_files/figure-commonmark/unnamed-chunk-34-1.png)

``` r
ggplot(data=gps, aes(x=fpa, y=roughness)) +
  geom_boxplot() +
  xlab("Absence-Presence") +
  ylab("Roughness") +
  facet_wrap(~season)
```

![](3.0-covariates-eda_files/figure-commonmark/unnamed-chunk-35-1.png)

### Eastness

``` r
plot(topo[['eastness']])
```

![](3.0-covariates-eda_files/figure-commonmark/unnamed-chunk-36-1.png)

``` r
ggplot(data=gps, aes(x=fpa, y=eastness)) +
  geom_boxplot() +
  xlab("Absence-Presence") +
  ylab("Eastness") +
  facet_wrap(~season)
```

![](3.0-covariates-eda_files/figure-commonmark/unnamed-chunk-37-1.png)

### Northness

``` r
plot(topo[['northness']])
```

![](3.0-covariates-eda_files/figure-commonmark/unnamed-chunk-38-1.png)

``` r
ggplot(data=gps, aes(x=fpa, y=northness)) +
  geom_boxplot() +
  xlab("Absence-Presence") +
  ylab("northness") +
  facet_wrap(~season)
```

![](3.0-covariates-eda_files/figure-commonmark/unnamed-chunk-39-1.png)
